/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@microsoft/signalr@8.0.7/dist/esm/JsonHubProtocol.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{MessageType}from"./IHubProtocol";import{LogLevel}from"./ILogger";import{TransferFormat}from"./ITransport";import{NullLogger}from"./Loggers";import{TextMessageFormat}from"./TextMessageFormat";const JSON_HUB_PROTOCOL_NAME="json";export class JsonHubProtocol{constructor(){this.name="json",this.version=2,this.transferFormat=TransferFormat.Text}parseMessages(e,s){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===s&&(s=NullLogger.instance);const o=TextMessageFormat.parse(e),r=[];for(const e of o){const o=JSON.parse(e);if("number"!=typeof o.type)throw new Error("Invalid payload.");switch(o.type){case MessageType.Invocation:this._isInvocationMessage(o);break;case MessageType.StreamItem:this._isStreamItemMessage(o);break;case MessageType.Completion:this._isCompletionMessage(o);break;case MessageType.Ping:case MessageType.Close:break;case MessageType.Ack:this._isAckMessage(o);break;case MessageType.Sequence:this._isSequenceMessage(o);break;default:s.log(LogLevel.Information,"Unknown message type '"+o.type+"' ignored.");continue}r.push(o)}return r}writeMessage(e){return TextMessageFormat.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,s){if("string"!=typeof e||""===e)throw new Error(s)}}
//# sourceMappingURL=/sm/ae053b51a99782431275bb98a791914116f6261babe69ef9dc9658544865a32c.map