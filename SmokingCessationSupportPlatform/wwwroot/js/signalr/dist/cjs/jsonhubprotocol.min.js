/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@microsoft/signalr@8.0.7/dist/cjs/JsonHubProtocol.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JsonHubProtocol=void 0;const IHubProtocol_1=require("./IHubProtocol"),ILogger_1=require("./ILogger"),ITransport_1=require("./ITransport"),Loggers_1=require("./Loggers"),TextMessageFormat_1=require("./TextMessageFormat"),JSON_HUB_PROTOCOL_NAME="json";class JsonHubProtocol{constructor(){this.name="json",this.version=2,this.transferFormat=ITransport_1.TransferFormat.Text}parseMessages(e,o){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===o&&(o=Loggers_1.NullLogger.instance);const s=TextMessageFormat_1.TextMessageFormat.parse(e),r=[];for(const e of s){const s=JSON.parse(e);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case IHubProtocol_1.MessageType.Invocation:this._isInvocationMessage(s);break;case IHubProtocol_1.MessageType.StreamItem:this._isStreamItemMessage(s);break;case IHubProtocol_1.MessageType.Completion:this._isCompletionMessage(s);break;case IHubProtocol_1.MessageType.Ping:case IHubProtocol_1.MessageType.Close:break;case IHubProtocol_1.MessageType.Ack:this._isAckMessage(s);break;case IHubProtocol_1.MessageType.Sequence:this._isSequenceMessage(s);break;default:o.log(ILogger_1.LogLevel.Information,"Unknown message type '"+s.type+"' ignored.");continue}r.push(s)}return r}writeMessage(e){return TextMessageFormat_1.TextMessageFormat.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if("number"!=typeof e.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,o){if("string"!=typeof e||""===e)throw new Error(o)}}exports.JsonHubProtocol=JsonHubProtocol;
//# sourceMappingURL=/sm/524bfaf0196a2b84139a2276b109bc24f177f7abc500ecd5cde85b74f7812940.map